# 미션 기록

## 1. API 구현

![스크린샷 2025-10-16 오후 3.00.12.png](%EB%AF%B8%EC%85%98%20%EA%B8%B0%EB%A1%9D/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2025-10-16_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_3.00.12.png)

![스크린샷 2025-10-16 오후 2.59.16.png](%EB%AF%B8%EC%85%98%20%EA%B8%B0%EB%A1%9D/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2025-10-16_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_2.59.16.png)

## **2. Controller → Service → Repository → DB 요청 흐름 정리**

### - 회원가입 API  **`POST /api/v1/users/signup`**

1. **사용자가 POST /api/v1/users/signup 요청을 보냄**

◦ 요청 Body에 name, email, password 등을 담아서 전송

| **단계** | 설명 |
| --- | --- |
| 1️⃣ Client | API 요청 전송 |
| 2️⃣ Controller | 요청 파싱, Service 호출 |
| 3️⃣ Service | 비즈니스 로직 수행 |
| 4️⃣ Repository | SQL 실행 |
| 5️⃣ DB | 실제 저장 |

### **- 가게 추가하기 API `POST /api/v1/stores`**

| **단계** | **설명** |
| --- | --- |
| 1️⃣ Client | 사용자가 특정 지역에 가게 정보를 입력하고 등록 요청을 보냄 |
| 2️⃣ Controller | 요청 body(지역 ID, 가게명, 주소 등)를 받아 Service로 전달 |
| 3️⃣ Service | 유효성 검사 (예: 동일 이름의 가게가 있는지 확인) 후 Repository 호출 |
| 4️⃣ Repository | INSERT INTO store ... 쿼리 실행 |
| 5️⃣ DB | 가게 데이터 저장 후 성공 응답 반환 |

### - **리뷰 추가하기 API `POST /api/v1/stores/:storeId/reviews`**

| **단계** | **설명** |
| --- | --- |
| 1️⃣ Client | 사용자가 특정 가게의 리뷰를 작성하여 전송 |
| 2️⃣ Controller | 요청을 받아 Service로 전달 |
| 3️⃣ Service | ① 가게 존재 여부 확인 → ② 리뷰 저장 요청 |
| 4️⃣ Repository | INSERT INTO review ... 쿼리 실행 |
| 5️⃣ DB | 리뷰 데이터 저장 후 성공 응답 반환 |

### - **미션 도전하기 API `POST /api/v1/missions/:missionId/challenge`**

| **단계** | **설명** |
| --- | --- |
| 1️⃣ Client | 사용자가 특정 미션에 도전 버튼을 누름 |
| 2️⃣ Controller | 요청(회원 ID, 미션 ID)을 받아 Service로 전달 |
| 3️⃣ Service | ① 이미 도전 중인지 확인 → ② 도전 중 아니면 등록 |
| 4️⃣ Repository | INSERT INTO member_mission ... 쿼리 실행 |
| 5️⃣ DB | 미션 도전 정보 저장 후 성공 응답 반환 |

## 3. 회원가입 API에 비밀번호 해싱 과정을 추가해 주세요.

→ **회원가입 시 비밀번호를 `bcrypt`로 해싱 후 DB에 저장하기**

**`user.dto.js`** 

→ 클라이언트에서 비밀번호를 받아와 userSignUp에 전달해야 하므로 bodyToUser에 password 추가

![스크린샷 2025-10-16 오후 6.25.41.png](%EB%AF%B8%EC%85%98%20%EA%B8%B0%EB%A1%9D/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2025-10-16_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_6.25.41.png)

**`user.service.js`**

→ bcrypt를 사용해서 비밀번호를 해싱한 뒤 DB에 저장

![스크린샷 2025-10-16 오후 6.26.17.png](%EB%AF%B8%EC%85%98%20%EA%B8%B0%EB%A1%9D/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2025-10-16_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_6.26.17.png)

**`user.repository.js`**
→ user 테이블에 password 컬럼을 포함시켜 비밀번호 저장

![스크린샷 2025-10-16 오후 6.27.19.png](%EB%AF%B8%EC%85%98%20%EA%B8%B0%EB%A1%9D/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2025-10-16_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_6.27.19.png)